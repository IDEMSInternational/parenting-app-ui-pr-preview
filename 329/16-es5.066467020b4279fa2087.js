!function(){function e(e,n){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e))||n&&e&&"number"==typeof e.length){i&&(e=i);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw c}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"42Ma":function(e,t,i){"use strict";i.d(t,"a",function(){return b});var a=i("mrSG"),c=i("iFvM"),o=i("qe0H"),s=i("JLHU"),u=i("8Y7J"),b=function(){var e=function(){function e(t){n(this,e),this.dbService=t}return r(e,[{key:"getHabitWeeklyCount",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Date((new Date).getTime()-6048e5),i=0,r=Object(c.a)(o.d[0].rows,"task_id"),t.next=5,this.dbService.table("task_actions").toArray();case 5:return t.sent.forEach(function(t){var a=new Date(t._created);t._completed&&a>n&&r.hasOwnProperty(t.task_id)&&r[t.task_id].id===e&&i++}),t.abrupt("return",i);case 7:case"end":return t.stop()}},t,this)}))}},{key:"setHabitWeeklyAim",value:function(e,t){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.dbService.table("habits").put({habitId:e,weeklyAim:t},"habitId"));case 1:case"end":return n.stop()}},n,this)}))}},{key:"getHabitWeeklyAim",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.dbService.table("habits").where("habitId").equals(e).first();case 3:if(!(n=t.sent)){t.next=6;break}return t.abrupt("return",n.weeklyAim);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn("No habit found for id",e,t.t0);case 11:return t.abrupt("return",null);case 12:case"end":return t.stop()}},t,this,[[0,8]])}))}},{key:"getUserHabitActivityIdeas",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.dbService.table("habit_activity_ideas").where("flowName").equals(e).toArray();case 3:return t.abrupt("return",t.sent.map(function(e){return e.ideaTitle}));case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",(console.log("No habit ideas for flow name ",e,t.t0),[]));case 9:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"addUserHabitActivityIdea",value:function(e,t){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.abrupt("return",this.dbService.table("habit_activity_ideas").add({flowName:e,ideaTitle:t}));case 4:return n.prev=4,n.t0=n.catch(0),n.abrupt("return",void console.log("Error adding habit activity idea for flow name: ",e,n.t0));case 7:case"end":return n.stop()}},n,this,[[0,4]])}))}},{key:"deleteUserHabitActivityIdea",value:function(e,t){try{return this.dbService.table("habit_activity_ideas").where("flowName").equals(e).and(function(e){return e.ideaTitle===t}).delete()}catch(n){console.log("Could not delete habit activity idea with title ".concat(t," for flow name ").concat(e)),console.log(n)}}},{key:"markHabitOccurrence",value:function(e){try{return this.dbService.table("habit_occurrence").add({id:null,created:new Date,habitId:e})}catch(t){console.log("Could not mark habit occurrence")}}},{key:"deleteLastHabitOccurrence",value:function(e){try{return this.dbService.table("habit_occurrence").add({id:null,created:new Date,habitId:e})}catch(t){console.log("Could not mark habit occurrence")}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u.Vb(s.a))},e.\u0275prov=u.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},KSn9:function(t,i,a){"use strict";a.r(i),a.d(i,"CarePackagesPageModule",function(){return j});var c=a("SVse"),o=a("s7LF"),s=a("sZkV"),u=a("iInd"),b=a("mrSG"),l=a("qe0H"),f=a("42Ma"),d=a("8Y7J"),g=["numSelect"];function p(e,t){if(1&e){var n=d.Sb();d.Rb(0,"button",9),d.Zb("click",function(){d.qc(n);var e=d.cc().$implicit;return d.cc().suggestedTaskClicked(e)}),d.Ac(1),d.Qb()}if(2&e){var i=d.cc().$implicit;d.Ab(1),d.Cc(" ",i.suggestion_button_text," ")}}function h(e,t){if(1&e&&(d.Rb(0,"span"),d.Ac(1),d.Qb()),2&e){var n=d.cc().$implicit;d.Ab(1),d.Cc(" ",n.set_aim_button_text?n.set_aim_button_text:"Set My Aim"," ")}}function m(e,t){if(1&e&&(d.Rb(0,"span"),d.Ac(1),d.Qb()),2&e){var n=d.cc().$implicit;d.Ab(1),d.Ec(" ",n.aim_button_text?n.aim_button_text:"My Aim",": ",n.timesDoneThisWeek," / ",n.weeklyAim," ")}}function v(e,t){if(1&e){var n=d.Sb();d.Rb(0,"section",3),d.Rb(1,"div",4),d.Rb(2,"div",5),d.Rb(3,"title"),d.Ac(4),d.Qb(),d.Rb(5,"p"),d.Ac(6),d.Qb(),d.Qb(),d.Nb(7,"img",6),d.Qb(),d.Rb(8,"div",7),d.yc(9,p,2,1,"button",8),d.Rb(10,"button",9),d.Zb("click",function(){d.qc(n);var e=t.$implicit;return d.cc().aimClicked(e)}),d.yc(11,h,2,1,"span",10),d.yc(12,m,2,3,"span",10),d.Qb(),d.Qb(),d.Qb()}if(2&e){var i=t.$implicit;d.Ab(4),d.Bc(i.title),d.Ab(2),d.Bc(i.description),d.Ab(1),d.ic("src",i.icon_asset,d.sc),d.Ab(2),d.ic("ngIf",i.suggestion_button_text),d.Ab(2),d.ic("ngIf",!i.weeklyAim),d.Ab(1),d.ic("ngIf",i.weeklyAim)}}function y(e,t){if(1&e&&(d.Rb(0,"ion-select-option",14),d.Ac(1),d.Qb()),2&e){var n=t.$implicit;d.ic("value",n),d.Ab(1),d.Cc(" ",n," ")}}function k(e,t){if(1&e){var n=d.Sb();d.Rb(0,"ion-select",11,12),d.Zb("ngModelChange",function(e){return d.qc(n),d.cc().selectedHabit.weeklyAim=e})("ngModelChange",function(){return d.qc(n),d.cc().onAimChange()}),d.yc(2,y,2,2,"ion-select-option",13),d.Qb()}if(2&e){var i=d.cc();d.ic("name",i.selectedHabit.id)("ngModel",i.selectedHabit.weeklyAim),d.Ab(2),d.ic("ngForOf",i.range(1,9))}}var w,x=((w=function(){function t(i,r,a){var c=this;n(this,t),this.router=r,this.habitService=a,this.habitById={},this.habits=[];var o,s=e(l.d[0].rows);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.habitById[u.id]=u}}catch(f){s.e(f)}finally{s.f()}i.params.subscribe(function(e){var t=e.carePackageId;t&&l.a&&l.a.length>0&&(c.carePackage=l.a[0].rows.find(function(e){return e.id===t}),Promise.all(c.carePackage.habit_list.map(function(e){return Object(b.a)(c,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.habitService.getHabitWeeklyCount(e);case 2:return n=t.sent,t.next=5,this.habitService.getHabitWeeklyAim(e);case 5:return i=t.sent,t.abrupt("return",Object.assign(Object.assign({},this.habitById[e]),{weeklyAim:i,timesDoneThisWeek:n}));case 7:case"end":return t.stop()}},t,this)}))})).then(function(e){c.selectedHabit=e[0],c.habits=e}))})}return r(t,[{key:"ngOnInit",value:function(){}},{key:"onAimChange",value:function(){this.habitService.setHabitWeeklyAim(this.selectedHabit.id,this.selectedHabit.weeklyAim)}},{key:"aimClicked",value:function(e){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.selectedHabit=e,this.numSelect.open();case 1:case"end":return t.stop()}},t,this)}))}},{key:"suggestedTaskClicked",value:function(e){this.router.navigate([e.suggestion_flow_type,e.suggestion_flow_name])}},{key:"range",value:function(e,t){for(var n=[],i=e;i<=t;i++)n.push(i);return n}}]),t}()).\u0275fac=function(e){return new(e||w)(d.Mb(u.a),d.Mb(u.h),d.Mb(f.a))},w.\u0275cmp=d.Gb({type:w,selectors:[["plh-care-package"]],viewQuery:function(e,t){var n;1&e&&d.Fc(g,!0),2&e&&d.nc(n=d.ac())&&(t.numSelect=n.first)},decls:7,vars:4,consts:[[1,"description"],["class","habit-section",4,"ngFor","ngForOf"],["hidden","true",3,"name","ngModel","ngModelChange",4,"ngIf"],[1,"habit-section"],[1,"top"],[1,"title-and-desc"],[3,"src"],[1,"buttons"],["class","btn",3,"click",4,"ngIf"],[1,"btn",3,"click"],[4,"ngIf"],["hidden","true",3,"name","ngModel","ngModelChange"],["numSelect",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(d.Rb(0,"ion-content"),d.Rb(1,"h1"),d.Ac(2),d.Qb(),d.Rb(3,"p",0),d.Ac(4),d.Qb(),d.yc(5,v,13,6,"section",1),d.yc(6,k,3,3,"ion-select",2),d.Qb()),2&e&&(d.Ab(2),d.Bc(null==t.carePackage?null:t.carePackage.label),d.Ab(2),d.Bc(null==t.carePackage?null:t.carePackage.description),d.Ab(1),d.ic("ngForOf",t.habits),d.Ab(1),d.ic("ngIf",t.selectedHabit))},directives:[s.j,c.k,c.l,s.w,s.J,o.e,o.f,s.x],styles:['.description[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{text-align:center}.habit-section[_ngcontent-%COMP%]{background-color:var(--ion-item-background,#fefefe);box-shadow:4px 4px 6px rgba(0,0,0,.5);border-radius:20px;margin:20px;padding:20px}.habit-section[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.habit-section[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   title[_ngcontent-%COMP%]{display:block;font-weight:700;font-size:1.2em}.habit-section[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:60px}.habit-section[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}.habit-section[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:var(--ion-color-primary-contrast,#fff);white-space:normal;background-color:var(--ion-color-primary,"darkblue");width:calc(50% - 10px);box-shadow:2px 2px 4px rgba(0,0,0,.5);border-radius:10px;margin-left:10px;padding:10px;height:100px;font-size:20px}']}),w);function _(e,t){if(1&e&&d.Nb(0,"img",5),2&e){var n=d.cc().$implicit;d.ic("src",n.icon_asset,d.sc)}}function A(e,t){1&e&&d.Nb(0,"img",6)}var O=function(e){return[e]};function C(e,t){if(1&e&&(d.Rb(0,"div",2),d.Rb(1,"label"),d.Ac(2),d.Qb(),d.yc(3,_,1,1,"img",3),d.yc(4,A,1,0,"img",4),d.Qb()),2&e){var n=t.$implicit;d.ic("routerLink",d.lc(4,O,n.id)),d.Ab(2),d.Bc(n.label),d.Ab(1),d.ic("ngIf",n.icon_asset),d.Ab(1),d.ic("ngIf",!n.icon_asset)}}var M,P,R,I=[{path:"",component:(M=function(){function e(){n(this,e),this.carePackages=[],l.a&&l.a.length>0&&(this.carePackages=l.a[0].rows)}return r(e,[{key:"ngOnInit",value:function(){}}]),e}(),M.\u0275fac=function(e){return new(e||M)},M.\u0275cmp=d.Gb({type:M,selectors:[["plh-care-packages"]],decls:5,vars:1,consts:[[1,"care-package-buttons"],["class","care-package-button",3,"routerLink",4,"ngFor","ngForOf"],[1,"care-package-button",3,"routerLink"],[3,"src",4,"ngIf"],["src","assets/images/blob_holding_heart1.svg",4,"ngIf"],[3,"src"],["src","assets/images/blob_holding_heart1.svg"]],template:function(e,t){1&e&&(d.Rb(0,"ion-content"),d.Rb(1,"h1"),d.Ac(2,"Care Packages"),d.Qb(),d.Rb(3,"div",0),d.yc(4,C,5,6,"div",1),d.Qb(),d.Qb()),2&e&&(d.Ab(4),d.ic("ngForOf",t.carePackages))},directives:[s.j,c.k,s.I,u.i,c.l],styles:["h1[_ngcontent-%COMP%]{text-align:center}.care-package-buttons[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap}.care-package-button[_ngcontent-%COMP%]{min-height:150px;box-sizing:border-box;display:flex;flex-basis:calc(50% - 20px);max-width:240px;border-radius:20px;margin:10px;padding:20px;background-color:var(--ion-item-background,#fff);box-shadow:4px 4px 6px rgba(0,0,0,.5);align-items:center;justify-content:space-between;flex-direction:column}.care-package-button[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px}.care-package-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:92px}"]}),M)},{path:":carePackageId",component:x}],S=((R=function e(){n(this,e)}).\u0275mod=d.Kb({type:R}),R.\u0275inj=d.Jb({factory:function(e){return new(e||R)},imports:[[u.j.forChild(I)],u.j]}),R),j=((P=function e(){n(this,e)}).\u0275mod=d.Kb({type:P}),P.\u0275inj=d.Jb({factory:function(e){return new(e||P)},imports:[[c.c,o.b,s.D,u.j,S]]}),P)}}])}();