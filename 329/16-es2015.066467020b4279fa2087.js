(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"42Ma":function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i("mrSG"),c=i("iFvM"),a=i("qe0H"),o=i("JLHU"),r=i("8Y7J");let s=(()=>{class t{constructor(t){this.dbService=t}getHabitWeeklyCount(t){return Object(n.a)(this,void 0,void 0,function*(){const e=new Date((new Date).getTime()-6048e5);let i=0;const n=Object(c.a)(a.d[0].rows,"task_id");return(yield this.dbService.table("task_actions").toArray()).forEach(c=>{const a=new Date(c._created);c._completed&&a>e&&n.hasOwnProperty(c.task_id)&&n[c.task_id].id===t&&i++}),i})}setHabitWeeklyAim(t,e){return Object(n.a)(this,void 0,void 0,function*(){return this.dbService.table("habits").put({habitId:t,weeklyAim:e},"habitId")})}getHabitWeeklyAim(t){return Object(n.a)(this,void 0,void 0,function*(){try{const e=yield this.dbService.table("habits").where("habitId").equals(t).first();if(e)return e.weeklyAim}catch(e){console.warn("No habit found for id",t,e)}return null})}getUserHabitActivityIdeas(t){return Object(n.a)(this,void 0,void 0,function*(){try{return(yield this.dbService.table("habit_activity_ideas").where("flowName").equals(t).toArray()).map(t=>t.ideaTitle)}catch(e){return console.log("No habit ideas for flow name ",t,e),[]}})}addUserHabitActivityIdea(t,e){return Object(n.a)(this,void 0,void 0,function*(){try{return this.dbService.table("habit_activity_ideas").add({flowName:t,ideaTitle:e})}catch(i){return void console.log("Error adding habit activity idea for flow name: ",t,i)}})}deleteUserHabitActivityIdea(t,e){try{return this.dbService.table("habit_activity_ideas").where("flowName").equals(t).and(t=>t.ideaTitle===e).delete()}catch(i){console.log(`Could not delete habit activity idea with title ${e} for flow name ${t}`),console.log(i)}}markHabitOccurrence(t){try{return this.dbService.table("habit_occurrence").add({id:null,created:new Date,habitId:t})}catch(e){console.log("Could not mark habit occurrence")}}deleteLastHabitOccurrence(t){try{return this.dbService.table("habit_occurrence").add({id:null,created:new Date,habitId:t})}catch(e){console.log("Could not mark habit occurrence")}}}return t.\u0275fac=function(e){return new(e||t)(r.Vb(o.a))},t.\u0275prov=r.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},KSn9:function(t,e,i){"use strict";i.r(e),i.d(e,"CarePackagesPageModule",function(){return C});var n=i("SVse"),c=i("s7LF"),a=i("sZkV"),o=i("iInd"),r=i("mrSG"),s=i("qe0H"),b=i("42Ma"),l=i("8Y7J");const d=["numSelect"];function u(t,e){if(1&t){const t=l.Sb();l.Rb(0,"button",9),l.Zb("click",function(){l.qc(t);const e=l.cc().$implicit;return l.cc().suggestedTaskClicked(e)}),l.Ac(1),l.Qb()}if(2&t){const t=l.cc().$implicit;l.Ab(1),l.Cc(" ",t.suggestion_button_text," ")}}function g(t,e){if(1&t&&(l.Rb(0,"span"),l.Ac(1),l.Qb()),2&t){const t=l.cc().$implicit;l.Ab(1),l.Cc(" ",t.set_aim_button_text?t.set_aim_button_text:"Set My Aim"," ")}}function h(t,e){if(1&t&&(l.Rb(0,"span"),l.Ac(1),l.Qb()),2&t){const t=l.cc().$implicit;l.Ab(1),l.Ec(" ",t.aim_button_text?t.aim_button_text:"My Aim",": ",t.timesDoneThisWeek," / ",t.weeklyAim," ")}}function f(t,e){if(1&t){const t=l.Sb();l.Rb(0,"section",3),l.Rb(1,"div",4),l.Rb(2,"div",5),l.Rb(3,"title"),l.Ac(4),l.Qb(),l.Rb(5,"p"),l.Ac(6),l.Qb(),l.Qb(),l.Nb(7,"img",6),l.Qb(),l.Rb(8,"div",7),l.yc(9,u,2,1,"button",8),l.Rb(10,"button",9),l.Zb("click",function(){l.qc(t);const i=e.$implicit;return l.cc().aimClicked(i)}),l.yc(11,g,2,1,"span",10),l.yc(12,h,2,3,"span",10),l.Qb(),l.Qb(),l.Qb()}if(2&t){const t=e.$implicit;l.Ab(4),l.Bc(t.title),l.Ab(2),l.Bc(t.description),l.Ab(1),l.ic("src",t.icon_asset,l.sc),l.Ab(2),l.ic("ngIf",t.suggestion_button_text),l.Ab(2),l.ic("ngIf",!t.weeklyAim),l.Ab(1),l.ic("ngIf",t.weeklyAim)}}function p(t,e){if(1&t&&(l.Rb(0,"ion-select-option",14),l.Ac(1),l.Qb()),2&t){const t=e.$implicit;l.ic("value",t),l.Ab(1),l.Cc(" ",t," ")}}function m(t,e){if(1&t){const t=l.Sb();l.Rb(0,"ion-select",11,12),l.Zb("ngModelChange",function(e){return l.qc(t),l.cc().selectedHabit.weeklyAim=e})("ngModelChange",function(){return l.qc(t),l.cc().onAimChange()}),l.yc(2,p,2,2,"ion-select-option",13),l.Qb()}if(2&t){const t=l.cc();l.ic("name",t.selectedHabit.id)("ngModel",t.selectedHabit.weeklyAim),l.Ab(2),l.ic("ngForOf",t.range(1,9))}}let k=(()=>{class t{constructor(t,e,i){this.router=e,this.habitService=i,this.habitById={},this.habits=[];for(let n of s.d[0].rows)this.habitById[n.id]=n;t.params.subscribe(t=>{const e=t.carePackageId;e&&s.a&&s.a.length>0&&(this.carePackage=s.a[0].rows.find(t=>t.id===e),Promise.all(this.carePackage.habit_list.map(t=>Object(r.a)(this,void 0,void 0,function*(){const e=yield this.habitService.getHabitWeeklyCount(t),i=yield this.habitService.getHabitWeeklyAim(t);return Object.assign(Object.assign({},this.habitById[t]),{weeklyAim:i,timesDoneThisWeek:e})}))).then(t=>{this.selectedHabit=t[0],this.habits=t}))})}ngOnInit(){}onAimChange(){this.habitService.setHabitWeeklyAim(this.selectedHabit.id,this.selectedHabit.weeklyAim)}aimClicked(t){return Object(r.a)(this,void 0,void 0,function*(){this.selectedHabit=t,this.numSelect.open()})}suggestedTaskClicked(t){this.router.navigate([t.suggestion_flow_type,t.suggestion_flow_name])}range(t,e){let i=[];for(var n=t;n<=e;n++)i.push(n);return i}}return t.\u0275fac=function(e){return new(e||t)(l.Mb(o.a),l.Mb(o.h),l.Mb(b.a))},t.\u0275cmp=l.Gb({type:t,selectors:[["plh-care-package"]],viewQuery:function(t,e){if(1&t&&l.Fc(d,!0),2&t){let t;l.nc(t=l.ac())&&(e.numSelect=t.first)}},decls:7,vars:4,consts:[[1,"description"],["class","habit-section",4,"ngFor","ngForOf"],["hidden","true",3,"name","ngModel","ngModelChange",4,"ngIf"],[1,"habit-section"],[1,"top"],[1,"title-and-desc"],[3,"src"],[1,"buttons"],["class","btn",3,"click",4,"ngIf"],[1,"btn",3,"click"],[4,"ngIf"],["hidden","true",3,"name","ngModel","ngModelChange"],["numSelect",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(l.Rb(0,"ion-content"),l.Rb(1,"h1"),l.Ac(2),l.Qb(),l.Rb(3,"p",0),l.Ac(4),l.Qb(),l.yc(5,f,13,6,"section",1),l.yc(6,m,3,3,"ion-select",2),l.Qb()),2&t&&(l.Ab(2),l.Bc(null==e.carePackage?null:e.carePackage.label),l.Ab(2),l.Bc(null==e.carePackage?null:e.carePackage.description),l.Ab(1),l.ic("ngForOf",e.habits),l.Ab(1),l.ic("ngIf",e.selectedHabit))},directives:[a.j,n.k,n.l,a.w,a.J,c.e,c.f,a.x],styles:['.description[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{text-align:center}.habit-section[_ngcontent-%COMP%]{background-color:var(--ion-item-background,#fefefe);box-shadow:4px 4px 6px rgba(0,0,0,.5);border-radius:20px;margin:20px;padding:20px}.habit-section[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.habit-section[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   title[_ngcontent-%COMP%]{display:block;font-weight:700;font-size:1.2em}.habit-section[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:60px}.habit-section[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}.habit-section[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:var(--ion-color-primary-contrast,#fff);white-space:normal;background-color:var(--ion-color-primary,"darkblue");width:calc(50% - 10px);box-shadow:2px 2px 4px rgba(0,0,0,.5);border-radius:10px;margin-left:10px;padding:10px;height:100px;font-size:20px}']}),t})();function y(t,e){if(1&t&&l.Nb(0,"img",5),2&t){const t=l.cc().$implicit;l.ic("src",t.icon_asset,l.sc)}}function _(t,e){1&t&&l.Nb(0,"img",6)}const v=function(t){return[t]};function w(t,e){if(1&t&&(l.Rb(0,"div",2),l.Rb(1,"label"),l.Ac(2),l.Qb(),l.yc(3,y,1,1,"img",3),l.yc(4,_,1,0,"img",4),l.Qb()),2&t){const t=e.$implicit;l.ic("routerLink",l.lc(4,v,t.id)),l.Ab(2),l.Bc(t.label),l.Ab(1),l.ic("ngIf",t.icon_asset),l.Ab(1),l.ic("ngIf",!t.icon_asset)}}const x=[{path:"",component:(()=>{class t{constructor(){this.carePackages=[],s.a&&s.a.length>0&&(this.carePackages=s.a[0].rows)}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Gb({type:t,selectors:[["plh-care-packages"]],decls:5,vars:1,consts:[[1,"care-package-buttons"],["class","care-package-button",3,"routerLink",4,"ngFor","ngForOf"],[1,"care-package-button",3,"routerLink"],[3,"src",4,"ngIf"],["src","assets/images/blob_holding_heart1.svg",4,"ngIf"],[3,"src"],["src","assets/images/blob_holding_heart1.svg"]],template:function(t,e){1&t&&(l.Rb(0,"ion-content"),l.Rb(1,"h1"),l.Ac(2,"Care Packages"),l.Qb(),l.Rb(3,"div",0),l.yc(4,w,5,6,"div",1),l.Qb(),l.Qb()),2&t&&(l.Ab(4),l.ic("ngForOf",e.carePackages))},directives:[a.j,n.k,a.I,o.i,n.l],styles:["h1[_ngcontent-%COMP%]{text-align:center}.care-package-buttons[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap}.care-package-button[_ngcontent-%COMP%]{min-height:150px;box-sizing:border-box;display:flex;flex-basis:calc(50% - 20px);max-width:240px;border-radius:20px;margin:10px;padding:20px;background-color:var(--ion-item-background,#fff);box-shadow:4px 4px 6px rgba(0,0,0,.5);align-items:center;justify-content:space-between;flex-direction:column}.care-package-button[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px}.care-package-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:92px}"]}),t})()},{path:":carePackageId",component:k}];let A=(()=>{class t{}return t.\u0275mod=l.Kb({type:t}),t.\u0275inj=l.Jb({factory:function(e){return new(e||t)},imports:[[o.j.forChild(x)],o.j]}),t})(),C=(()=>{class t{}return t.\u0275mod=l.Kb({type:t}),t.\u0275inj=l.Jb({factory:function(e){return new(e||t)},imports:[[n.c,c.b,a.D,o.j,A]]}),t})()}}]);